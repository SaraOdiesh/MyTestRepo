Some modifications 
Some changes form the master
